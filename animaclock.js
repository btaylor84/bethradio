_alarmControllerID=0;function alarmController(aniclock,aniclockName,divID){this.aniclock=aniclock;this.aniclockName=aniclockName;_alarmControllerID++;this.alarmQueue=[];this.div=document.getElementById(divID);this.div.style.width="100%";this.div.style.textAlign="margin-top: 3px;";this.div.style.padding="10px";this.reverseBGColor=(this.aniclock.setBodyColor!=undefined&&this.aniclock.setBodyColor==true)?animaclock_col2str(animaclock_invertColor(this.aniclock.digitPanel.currentBGColor())):"black";var menuStyle="font-size: 8pt; text-align: right;";this.canvasID="_alarmControllerCanvasID"+_alarmControllerID;this.youtubeID="_alarmControllerYoutubeID"+_alarmControllerID;this.deleteID="_alarmControllerDeleteID"+_alarmControllerID;this.timeFieldID="_alarmControllerTimeFieldID"+_alarmControllerID;this.timerFieldID="_alarmControllerTimerFieldID"+_alarmControllerID;this.canvas=null;this.context=null;this.H=110;this.pad=50;this.nowTickSize=16;this.nowTickWidth=4;this.nowTickColor="#222";this.tickWidth=1;this.tickColor="#bbb";this.tickSize=10;this.handleSize=12;this.lineWidth=3;this.dayY=0.32*this.H;this.hourY=0.68*this.H;this.font="12px 'Helvetica Neue',Helvetica,Arial,sans-serif;";this.labelColor="#000";this.lineColor="#000";this.dayHandleColor="rgba(200,50,50,0.8)";this.hourHandleColor="rgba(50,50,200,0.8)";this.tSec=0;this.tSecNow=0;this.killed=false;this.isDragging=false;this.draggingDay=null;this.alarmIndex=-1;this.isOpen=false;this.openController=function(alarmIndex){this.isOpen=true;this.setOpenStyle();var tSec;if(alarmIndex<0||alarmIndex>=this.alarmQueue.length){tSec=this.getTSecNow()+15*60;alarmIndex=this.alarmQueue.length}else{tSec=this.alarmQueue[alarmIndex].t}this.alarmIndex=alarmIndex;this.tSec=tSec;this.aniclock.settingAlarm=true;var s=this.renderControlMenu();s+="<canvas id='"+this.canvasID+"' width='"+aniclock.canvas.width+"' height='"+this.H+"'>";this.div.innerHTML=s;this.updateTimeField();this.waitForCanvas()};this.updateTimeField=function(){var curHT=this.humanReadableTime(this.tSec,true);document.getElementById(this.timeFieldID).value=curHT};this.updateTimeFromField=function(){this.tSec=this.parseTimeFromStr(document.getElementById(this.timeFieldID).value)};this.renderControlMenu=function(){var s="<table style='"+menuStyle+"color: black;' width='100%' cellspacing=0 cellpadding=0>";s+="<td align=left>drag squares below to set time & save:</td>";s+="<td align=center>";s+="<input id='"+this.timeFieldID+"' type=text size=10 onblur='"+this.aniclockName+".alarmController.updateTimeFromField()'>";s+="</td>";s+="<td align=right>";s+="<a href='javascript:"+this.aniclockName+".alarmController.saveClose();'>[save]</a>  ";s+="<a href='javascript:"+this.aniclockName+".alarmController.closeController();'>[cancel]</a>";s+="</td></tr></table>";return s};this.waitForCanvas=function(){var c=document.getElementById(this.canvasID);if(c==undefined||c==null){setTimeout(this.waitForCanvas.bind(this),25)}else{this.startAnimation()}};this.close=function(){this.isOpen=false;this.killed=true;this.setCloseStyle();this.aniclock.settingAlarm=false};this.setCloseStyle=function(){this.div.style.backgroundColor="transparent";this.div.style.borderStyle="none"};this.setOpenStyle=function(){this.div.style.backgroundColor="rgb(240,240,240)";this.div.style.border="1px";this.div.style.borderStyle="solid";this.div.style.borderColor="rgb(140,140,140)"};this.saveClose=function(){this.close();this.alarmQueue[this.alarmIndex]={t:this.tSec,on:true};this.queueToSession();this.div.innerHTML=this.renderMinimizedView()};this.closeController=function(){this.close();this.div.innerHTML=this.renderMinimizedView()};this.deleteEntry=function(index){if(this.alarmQueue[index]!=undefined){this.alarmQueue.splice(index,1);this.queueToSession()}};this.deleteEntryAndRender=function(index){this.deleteEntry(index);this.div.innerHTML=this.renderMinimizedView()};this.checkAlarms=function(currentTime){if(this.aniclock.timerSeconds<=0.1&&this.aniclock.timerOn){this.triggerTimerAlarm()}if(this.isOpen){return}if(this.alarmQueue.length==0){return}var t=currentTime.getHours()*3600+currentTime.getMinutes()*60+currentTime.getSeconds();for(var i=0;i<this.alarmQueue.length;i++){if((t>=this.alarmQueue[i].t-0.1)&&t<=(this.alarmQueue[i].t+15)&&this.alarmQueue[i].on){this.isOpen=true;this.alarmQueue[i].on=false;this.triggerAlarm(i);return}}};this.triggerAlarm=function(index){this.aniclock.alarmOn=true;this.showKillAlarmUI(index);this.playSound("JITI0FskSG0")};this.showKillAlarmUI=function(index){var s="";s+="<input type=button onclick='"+this.aniclockName+".alarmController.killAlarm("+index+");' value='STOP ALARM'>  ";s+="<input type=button onclick='"+this.aniclockName+".alarmController.snoozeAlarm("+index+");' value='SNOOZE'>";this.div.innerHTML=s};this.killAlarm=function(index){this.aniclock.alarmOn=false;this.killSound();this.deleteEntryAndRender(index);this.isOpen=false};this.snoozeAlarm=function(index){this.aniclock.alarmOn=false;this.killSound();this.alarmQueue[index].t+=9*60;this.queueToSession();this.div.innerHTML=this.renderMinimizedView();this.alarmQueue[i].on=true;this.isOpen=false};this.triggerTimerAlarm=function(){this.aniclock.alarmOn=true;this.showKillTimerAlarmUI();this.playSound("JITI0FskSG0")};this.showKillTimerAlarmUI=function(){var s="";s+="<input type=button onclick='"+this.aniclockName+".alarmController.killTimerAlarm();' value='STOP ALARM'>  ";this.div.innerHTML=s};this.killTimerAlarm=function(){this.killSound();this.aniclock.alarmOn=false;this.aniclock.killTimer();this.div.innerHTML=this.renderMinimizedView()};this.snoozeTimerAlarm=function(){this.aniclock.alarmOn=false;this.killSound();this.aniclock.timeOffset+=9*60;this.div.innerHTML=this.renderMinimizedView()};this.revertDelete=function(index){var style='style="color:'+this.reverseBGColor+'"';var s="<a "+style+" href='javascript:"+this.aniclockName+".alarmController.confirmDelete("+index+");'>delete</a>";document.getElementById(this.deleteID+"_"+index).innerHTML=s};this.confirmDelete=function(index){var style='style="color:'+this.reverseBGColor+'"';var s="are you sure? ";s+="<a "+style+" href='javascript:"+this.aniclockName+".alarmController.revertDelete("+index+");'>no</a> / ";s+="<a "+style+" href='javascript:"+this.aniclockName+".alarmController.deleteEntryAndRender("+index+");'>yes</a>";document.getElementById(this.deleteID+"_"+index).innerHTML=s};this.renderMinimizedView=function(){var style='style="font-size:14px; color:'+this.reverseBGColor+'"';var s="<table border=0 cellspacing=0 cellpadding=0 width='100%'>";var fontName=eval(this.aniclockName).anifont.fontName;s+="<td><a "+style+" href='/editfont?font="+fontName+"'>customize <strong>"+fontName+"</strong></a></td>";s+="<td>";s+="<div style='"+menuStyle+"color: "+this.reverseBGColor+"'>";for(var i=0;i<this.alarmQueue.length;i++){ht=this.humanReadableTime(this.alarmQueue[i].t,false);s+="[ "+ht+" : <a "+style+" href='javascript:"+this.aniclockName+".alarmController.openController("+i+");'>edit</a> | ";s+="<div id='"+this.deleteID+"_"+i+"' style='display:inline;'>";s+="<a "+style+" href='javascript:"+this.aniclockName+".alarmController.confirmDelete("+i+");'>delete</a>";s+="</div>";s+=" ]"}s+=" <a "+style+" href='javascript:"+this.aniclockName+".alarmController.openController(-1);'>+alarm</a> / ";if(!this.aniclock.timerOn){s+=" <a "+style+" href='javascript:"+this.aniclockName+".alarmController.openTimerController();'>timer</a>"}else{s+=" <a "+style+" href='javascript:"+this.aniclockName+".alarmController.killTimer();'>kill timer</a>"}s+="</div>";s+"</td></tr></table>";return s};this.openTimerController=function(){var s="<table style='"+menuStyle+"color: black;' width='100%' cellspacing=0 cellpadding=12>";var doOnSubmit=this.aniclockName+".alarmController.saveCloseTimer();";var enterEvent="onkeydown='if (event.keyCode == 13) "+doOnSubmit+"'";s+="<tr>";s+="<td align=right>";s+="<a href='javascript:"+doOnSubmit+"'>[start timer]</a>  ";s+="<a href='javascript:"+this.aniclockName+".alarmController.closeTimerController();'>[cancel]</a>";s+="</td>";s+="</tr>";s+="<tr>";s+="<td align=right>";var doOnCountupSubmit=this.aniclockName+".alarmController.saveCloseTimerUp();";s+="<a href='javascript:"+doOnCountupSubmit+"' style='color: BLACK; font-size: 120%; font-weight: BOLD; text-decoration: underline;'>Just start timer!</a>";s+="<br><br>";s+="Enter Timer Length: <input id='"+this.timerFieldID+"' type=text size=10 "+enterEvent+">";s+="</td></tr>";s+="<tr><td>";s+="<h2>How to input time:</h2>";s+="<ul>";s+="<b>mm:ss</b> or <b>hh:mm:ss</b> or just <b>ss</b><br>";s+="<b>mm</b> min<br>";s+="<b>ss</b> sec<br>";s+="<b>hh</b> hr<br>";s+="</ul>";s+="</td></tr>";s+="</table>";this.div.innerHTML=s;this.waitForTimerField()};this.waitForTimerField=function(){var c=document.getElementById(this.timerFieldID);if(c==undefined||c==null){setTimeout(this.waitForTimerField.bind(this),25)}else{c.focus()}};this.getTimerLengthFromGUI=function(){var tStr=document.getElementById(this.timerFieldID).value;return this.parseTimerLengthFromStr(tStr)+1};this.saveCloseTimer=function(){var timerLength=this.getTimerLengthFromGUI();this.aniclock.startTimer(timerLength,1);this.div.innerHTML=this.renderMinimizedView()};this.saveCloseTimerUp=function(){var timerLength=24*60*60;this.aniclock.startTimer(timerLength,0);this.div.innerHTML=this.renderMinimizedView()};this.closeTimerController=function(){this.div.innerHTML=this.renderMinimizedView()};this.killTimer=function(){this.aniclock.killTimer();this.div.innerHTML=this.renderMinimizedView()};this.parseTimeFromStr=function(s){s=s.toLowerCase();s=s.replace(/[^\d|\:|a|p|m]/g,"");var pat=new Array();pat[0]=/^(\d+)\:(\d+)\:(\d+)(a|p)m?$/;pat[1]=/^(\d+)\:(\d+)(a|p)m?$/;pat[2]=/^(\d+)\:(\d+)\:(\d+)$/;pat[3]=/^(\d+)\:(\d+)$/;pat[4]=/^(\d+)(a|p)m?$/;pat[5]=/^(\d+)$/;var hours=0;var minutes=0;var seconds=0;var ispm=false;for(var i=0;i<pat.length;i++){var r=s.match(pat[i]);if(r!=null){hours=r[1];if(r.length==2){break}if(animaclock_isNumeric(r[2])){minutes=r[2]}else{ispm=r[2]=="p"}if(r[3]!=undefined){if(animaclock_isNumeric(r[3])){seconds=r[3]}else{ispm=r[3]=="p"}}if(r[4]!=undefined){ispm=r[4]=="p"}break}}hours=parseFloat(hours);minutes=parseFloat(minutes);seconds=parseFloat(seconds);if(!this.aniclock.is24hour){if(!ispm&&(hours==12)){hours=0}else{if(ispm&&(hours<12)){hours+=12}}}var t=hours*3600+minutes*60+seconds;if(t<0){t=0}else{if(t>86399){t=86399}}return t};this.parseTimerLengthFromStr=function(s){s=s.toLowerCase();s=s.replace(/[^\d|\:|m|i|n|u|t|e|s|h|o|u|r|c|d]/g,"");var pat=new Array();pat[0]=/^(\d+)\:(\d+)\:(\d+)?$/;pat[1]=/^(\d+)\:(\d+)?$/;pat[2]=/^(\d+)$/;pat[3]=/^(\d+)m(in|inute|n)?s?$/;pat[4]=/^(\d+)h(r|our)?s?$/;pat[5]=/^(\d+)s(ec|econd)?s?$/;var hours=0;var minutes=0;var seconds=0;for(var i=0;i<pat.length;i++){var r=s.match(pat[i]);if(r!=null&&i==0){hours=r[1];minutes=r[2];seconds=r[3]}else{if(r!=null&&i==1){minutes=r[1];seconds=r[2]}else{if(r!=null&&i==2){seconds=r[1]}else{if(r!=null&&i==3){minutes=r[1]}else{if(r!=null&&i==4){hours=r[1]}else{if(r!=null&&i==5){seconds=r[1]}}}}}}}hours=parseFloat(hours);minutes=parseFloat(minutes);seconds=parseFloat(seconds);var t=hours*3600+minutes*60+seconds;if(t>86399){t=86399}return t};this.humanReadableTime=function(t,withSeconds){var h=Math.floor(t/3600);var m=Math.floor((t%3600)/60);if(m<10){m="0"+m}var s="";if(withSeconds){s=Math.round(t%60);if(s<10){s="0"+s}s=":"+s}var ampm="";if(!this.aniclock.is24hour){ampm=(h<12)?"am":"pm";if(h>12){h-=12}else{if(h==0){h=12}}}return h+":"+m+s+ampm};this.humanReadableOffset=function(dt,withSeconds){if(dt<0){dt=3600*24+dt}var h=Math.floor(dt/3600);var m=Math.floor((dt%3600)/60);if(m<10){m="0"+m}var s="";if(withSeconds){s=Math.round(dt%60);if(s<10){s="0"+s}s=":"+s}return h+":"+m+s};this.startAnimation=function(){this.killed=false;this.canvas=document.getElementById(this.canvasID);this.context=this.canvas.getContext("2d");this.canvas.addEventListener("mousedown",this.mouseDownFunc.bind(this),false);this.canvas.addEventListener("mouseup",this.mouseUpFunc.bind(this),false);this.canvas.addEventListener("mousemove",this.mouseMoveFunc.bind(this),false);this.canvas.addEventListener("touchstart",this.mouseDownFunc.bind(this),false);this.canvas.addEventListener("touchend",this.mouseUpFunc.bind(this),false);this.canvas.addEventListener("touchmove",this.mouseMoveFunc.bind(this),false);this.animateController()};this.getTSecNow=function(){var currentTime=new Date();currentTime.setTime(currentTime.getTime()+(this.aniclock.timeOffset+this.aniclock.officialOffset)*1000);this.tSecNow=currentTime.getHours()*3600+currentTime.getMinutes()*60+currentTime.getSeconds()+currentTime.getMilliseconds()/1000;return this.tSecNow};this.animateController=function(){if(this.killed){return}this.getTSecNow();this.nowDayX=this.positionOfTime(this.tSecNow);this.nowHourX=this.hourPositionOfTime(this.tSecNow);this.context.save();this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.lineWidth=this.lineWidth;this.context.fillStyle=this.lineColor;this.context.strokeStyle=this.lineColor;animaclock_drawline(this.context,this.pad,this.dayY,this.canvas.width-this.pad,this.dayY);this.makeDayMarkings();this.context.textBaseline="middle";this.context.fillStyle=this.labelColor;this.context.textAlign="right";animaclock_drawText(this.context,"set hour",this.pad-5,this.dayY);this.context.fillStyle=this.dayHandleColor;var x=this.positionOfTime(this.tSec);this.context.fillRect(x-this.handleSize/2,this.dayY-this.handleSize/2,this.handleSize,this.handleSize);this.context.lineWidth=this.lineWidth;this.context.fillStyle=this.lineColor;this.context.strokeStyle=this.lineColor;animaclock_drawline(this.context,this.pad,this.hourY,this.canvas.width-this.pad,this.hourY);this.makeHourMarkings();this.context.textBaseline="middle";this.context.fillStyle=this.labelColor;var curHour=Math.floor(this.tSec/3600);if(!this.aniclock.is24hour){var ampm=(curHour<12)?"am":"pm";if(curHour>12){curHour-=12}else{if(curHour==0){curHour=12}}curHour+=" "+ampm}this.context.textAlign="right";animaclock_drawText(this.context,curHour,this.pad-5,this.hourY);this.context.fillStyle=this.hourHandleColor;var x=this.hourPositionOfTime(this.tSec);this.context.fillRect(x-this.handleSize/2,this.hourY-this.handleSize/2,this.handleSize,this.handleSize);this.context.fillStyle=this.labelColor;this.context.textAlign="right";this.context.textBaseline="bottom";var txt="now: "+this.humanReadableTime(this.tSecNow,true);txt+="  alarm: +"+this.humanReadableOffset(this.tSec-this.tSecNow,true);animaclock_drawText(this.context,txt,this.canvas.width,this.canvas.height);this.context.restore();setTimeout(this.animateController.bind(this),15)};this.makeDayMarkings=function(){this.context.textAlign="center";for(var hour=3;hour<=21;hour+=3){var xPos=this.positionOfTime(hour*3600);var displayHour=hour;if(hour>12&&!this.aniclock.is24hour){displayHour-=12}this.makeMarking(""+displayHour,xPos,this.dayY,"top")}this.makeMarking("now",this.nowDayX,this.dayY,"bottom",this.nowTickWidth,this.nowTickColor,this.nowTickSize)};this.makeHourMarkings=function(){this.context.textAlign="center";for(var minute=5;minute<=55;minute+=5){var xPos=this.hourPositionOfTime(minute*60);this.makeMarking(""+minute,xPos,this.hourY,"top")}if(Math.floor(this.tSecNow/3600)==Math.floor(this.tSec/3600)){this.makeMarking("now",this.nowHourX,this.hourY,"bottom",this.nowTickWidth,this.nowTickColor,this.nowTickSize)}};this.makeMarking=function(txt,x,y,pos,tickWidth,tickColor,tickSize_){this.context.lineWidth=tickWidth||this.tickWidth;this.context.fillStyle=tickColor||this.tickColor;this.context.strokeStyle=tickColor||this.tickColor;var tickSize=tickSize_||this.tickSize;animaclock_drawline(this.context,x,y-tickSize/2,x,y+tickSize/2);if(txt){if(pos=="top"){this.context.textBaseline="bottom";animaclock_drawText(this.context,txt,x,y-tickSize/2-2)}else{this.context.textBaseline="top";animaclock_drawText(this.context,txt,x,y+tickSize/2+2)}}};this.mouseDownFunc=function(e){this.isDragging=false;var p=this.getCursorPosition(e);var x=this.positionOfTime(this.tSec);var xh=this.hourPositionOfTime(this.tSec);if(Math.abs(p[0]-x)<12&&Math.abs(p[1]-this.dayY)<8){this.isDragging=true;this.draggingDay=true;document.body.style.cursor="pointer"}else{if(Math.abs(p[0]-xh)<12&&Math.abs(p[1]-this.hourY)<8){this.isDragging=true;this.draggingDay=false;document.body.style.cursor="hand"}}};this.mouseMoveFunc=function(e){if(!this.isDragging){return}var p=this.getCursorPosition(e);if(this.draggingDay){this.tSec=this.timeOfPosition(p[0]);if(this.tSec<0){this.tSec=0}if(this.tSec>86399){this.tSec=86399}}else{this.currentHour=Math.floor(this.tSec/3600);var dt=this.minuteOfPosition(p[0]);if(dt>3599){dt=3599}if(dt<0){dt=0}this.tSec=this.currentHour*3600+dt}this.updateTimeField()};this.mouseUpFunc=function(e){this.isDragging=false;document.body.style.cursor="default"};this.positionOfTime=function(tSec){return this.pad+(tSec/86400)*(this.canvas.width-2*this.pad)};this.hourPositionOfTime=function(tSec){var frac=(tSec%3600)/3600;return this.pad+frac*(this.canvas.width-2*this.pad)};this.timeOfPosition=function(pos){var t=(pos-this.pad)/(this.canvas.width-2*this.pad)*86400;return t};this.minuteOfPosition=function(pos){var t=(pos-this.pad)/(this.canvas.width-2*this.pad)*3600;return Math.round(t/15)*15};this.getCursorPosition=function(e){return animaclock_getCursorPosition(e,this.canvasID)};this.playSound=function(v){var s='<object style="height: 1px; width: 1px">';s+='<param name="movie" value="http://www.youtube.com/v/'+v+'&autoplay=1">';s+='<param name="allowFullScreen" value="true">';s+='<param name="allowScriptAccess" value="always">';s+='<embed src="http://www.youtube.com/v/'+v+'&autoplay=1" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="1" height="1"></object>';s='<div id="'+this.youtubeID+'">'+s+"</div>";this.div.innerHTML=this.div.innerHTML+s};this.killSound=function(){var obj=document.getElementById(this.youtubeID);if(obj!=undefined&&obj!=null){obj.innerHTML=""}};this.queueToSession=function(){$.post("/savealarm",{queue:this.serializeQueue()},function(data){})};this.serializeQueue=function(){var s="";for(var i=0;i<this.alarmQueue.length;i++){if(this.alarmQueue[i].t>0){s+=Math.round(this.alarmQueue[i].t)+","}}return s};this.setQueue=function(queue){this.alarmQueue=queue;for(var i=0;i<this.alarmQueue.length;i++){this.alarmQueue[i].t=parseFloat(this.alarmQueue[i].t)}this.div.innerHTML=this.renderMinimizedView()};$.getJSON("/alarmlist",this.setQueue.bind(this));this.div.innerHTML=this.renderMinimizedView()};
function getGlobalAnimation_pos(h,g,t,b){switch(b.type){case"hop":var n=(b.height==undefined)?this.height/4:(b.height*this.height);var i=n*(1-4*(t-0.5)*(t-0.5));var d=g-i;return[h,d];case"wave":var e=(b.height==undefined)?this.height/4:(b.height*this.height);var p=(h-this.canvas.width)/this.canvas.width*2*Math.PI;var s=Math.sin(p+t*2*Math.PI);var i=s*s*e;var d=g-i;return[h,d];break;case"sidewave":var e=(b.height==undefined)?this.width/4:(b.height*this.width);var p=(g-this.canvas.height)/this.canvas.height*2*Math.PI;var s=Math.sin(p+t*2*Math.PI);var k=s*s*e;var r=h-k;return[r,g];break;case"expand":var q=this.canvas.width/2;var c=this.canvas.height/2;var k=(h-q);var i=(g-c);var j=b.min==undefined?0.4:b.min;var l=b.max==undefined?1.1:b.max;k*=j+(l-j)*Math.sin(t*Math.PI);i*=j+(l-j)*Math.sin(t*Math.PI);return[q+k,c+i];break;case"squeeze":var q=this.canvas.width/2;var c=this.canvas.height/2;var k=(h-q);var i=(g-c);var j=b.min==undefined?0.4:b.min;var l=b.max==undefined?1.1:b.max;var a=j+(l-j)*Math.sin(t*Math.PI);var o;if(b.from==undefined||b.from!="side"){o=Math.abs((h-this.canvas.width/2)/(this.canvas.width/2))}else{o=Math.abs((g-this.canvas.height/2)/(this.canvas.height/2))}var m=0.6+0.4*o*Math.sin(Math.PI*t);a*=m;k*=a;i*=a;return[q+k,c+i];break;default:return[h,g];break}};
var _animaclock_list=new Array();var _animaclock_official_offset;function animaClock(f,c,g,e,d,b,a){_animaclock_list.push(this);this.clockType="normal";this.canvas=document.getElementById(f);this.context=this.canvas.getContext("2d");this.anifont=animaclock_cloneFontSetDefaults(c);this.context.lineCap=this.anifont.lineCap;this.is24hour=(g==undefined)?false:g;this.is24hourOriginal=this.is24hour;this.updateInterval=(e!=undefined)?e:25;this.updateIntervalOriginal=this.updateInterval;this.labelStroke=false;this.doSetTitle=(d!=undefined)?d:true;this.timeOffset=(b!=undefined)?b:0;this.isOfficial=false;this.officialOffset=0;this.setOfficial=function(h){this.officialOffset=h;this.isOfficial=true};if(_animaclock_official_offset!=undefined){this.setOfficial(_animaclock_official_offset)}this.context.globalAlpha=(a!=undefined)?a:1;this.alarmOn=false;this.alarm=this.anifont.alarm;this.alarmLoopT=0;this.alarmController=null;this.settingAlarm=false;this.timerStartTime=null;this.timerOn=false;this.timerLength=null;this.timerCountsDown=null;this.originallyConnected=this.anifont.connected;this.timerSeconds=600;this.startTimer=function(i,h){if(this.timerOn){this.killTimer()}this.timerStartTime=new Date();this.is24hour=true;this.timerOn=true;this.timerLength=i==undefined?60*10:i;this.timerCountsDown=(h==undefined)?true:h;if(this.timerCountsDown){this.digitPanel.adjustAniTimesBackwards();this.anifont.connected=false}};this.killTimer=function(){this.is24hour=this.is24hourOriginal;this.digitPanel.adjustAniTimesForwards();this.timerOn=false;this.anifont.connected=this.originallyConnected};this.getTimerTime=function(){var i=new Date();var h;if(this.timerCountsDown){h=-i.getTime()+this.timerStartTime.getTime()+this.timerLength*1000;if(h<=0){this.timerLength+=10}}else{h=i.getTime()-this.timerStartTime.getTime();if(h>=this.timerLength*1000){h=this.timerLength*1000}}this.timerSeconds=h;i.setHours(Math.floor(h/(1000*60*60)));i.setMinutes(Math.floor(h/(1000*60))%60);i.setSeconds(Math.floor(h/1000)%60);i.setMilliseconds(h%1000);i.setTime(i.getTime()+this.timeOffset*1000);return i};this.getCurrentTime=function(){var h=new Date();h.setTime(h.getTime()+(this.timeOffset+this.officialOffset)*1000);return h};this.animateClock=function(){if(this.isKilled){this.safeKill();return}var j;if(this.timerOn){j=this.getTimerTime();if(!this.alarmOn&&this.alarmController!=null){this.alarmController.checkAlarms(j)}}else{if(!this.settingAlarm){j=this.getCurrentTime();if(!this.alarmOn&&this.alarmController!=null){this.alarmController.checkAlarms(j)}}else{j=new Date();var o=Math.round(this.alarmController.tSec);j.setHours(Math.floor(o/3600));j.setMinutes(Math.floor(o/60)%60);j.setSeconds(o%60);j.setMilliseconds(0)}}var l=j.getHours();var n=l;if(!this.is24hour){n=(l<12?l:(l-12));n=(n==0)?12:n}var m=j.getMinutes();var k=j.getSeconds()+j.getMilliseconds()/1000;var p=((l<12)?"am":"pm");this.meridiem=p;var h=function(q){q=Math.floor(q);return q<10?"0"+q:q+""};if(this.doSetTitle){if(!this.alarmOn){var i=p;if(this.timerOn){i=""}document.title=n+":"+h(m)+":"+h(k)+" "+i+" - animaclock"}else{if((Math.round(3*k)%2)==0){document.title="ALARM - ANIMACLOCK!"}else{document.title="-------------------"}}}this.digitPanel.currentTime=j;this.digitPanel.render(n+m/60+k/3600,m+k/60,k);setTimeout(this.animateClock.bind(this),this.updateInterval)};this.isKilled=false;this.safeKill=function(){for(var h in this){this[h]=null}};this.kill=function(){this.isKilled=true};this.startDigitPanel=function(){var k=this.canvas;afont=this.anifont;var o=k.width*afont.widthFrac;var h=Math.round((o-3*afont.groupPad-3*afont.digitPad)/6);var n=Math.round(k.height*afont.heightFrac);var j=Math.round(k.height*(1-afont.heightFrac)/2);var m=Math.round(k.width*(1-afont.widthFrac)/2);this.anifont.baseLineWidth=Math.ceil(k.width/600*afont.baseLineWidth);this.anifont.partLineWidth=Math.ceil(k.width/600*afont.partLineWidth);if(this.anifont.colonRadius.length==2){for(var l=0;l<2;l++){this.anifont.colonRadius[l]=Math.ceil(k.width/600*afont.colonRadius[l])}}else{this.anifont.colonRadius=Math.ceil(k.width/600*afont.colonRadius)}return new animaclock_digitPanel(this.anifont.digitPad,this.anifont.groupPad,m,j,h,n,this.canvas,this.anifont,this)};this.digitPanel=this.startDigitPanel();setTimeout(this.animateClock.bind(this),this.updateInterval)};
function animaclock_digit(f,p,s,q,n,e,x,d,c,h,a){this.left=f;this.top=p;this.width=s;this.height=q;this.baseColor=x;this.afont=h;this.digitPanel=a;this.canvas=d;this.context=c;this.drawBaseDigitPrepare=animaclock_drawBaseDigitPrepare;this.drawPartDigitPrepare=animaclock_drawPartDigitPrepare;this.drawDigit=animaclock_drawDigit;if(this.afont.sevenSegment){this.drawBaseDigit=animaclock_drawBaseDigit;this.drawPartDigit=animaclock_drawPartDigit;this.drawBaseDigitEdge=animaclock_drawBaseDigitEdge}else{this.drawBaseDigit=animaclock_drawBaseSmoothDigit;this.drawPartDigit=animaclock_drawPartSmoothDigit;this.strokes=animaclock_normalizeStrokes(this.afont.strokes,f,p,s,q,s/30)}this.getGlobalAnimation_pos=getGlobalAnimation_pos;this.isLeading=n;this.digitType=e;this.beginAniTime=h.beginAniTime;this.endAniTime=h.endAniTime;if((this.digitPanel.aniclock.clockType=="normal")&&(!this.afont.scaledDurations)){var u=this.afont.transitionDurations;var r=0;var t=0;if(!this.isLeading&&this.digitType==3){t=1;r=u.secL}else{if(this.isLeading&&this.digitType==3){t=1/10;r=u.secH}else{if(!this.isLeading&&this.digitType==2){t=1/60;r=u.minL}else{if(this.isLeading&&this.digitType==2){t=1/600;r=u.minH}else{if(!this.isLeading&&this.digitType==1){t=1/3600;r=u.hourL}else{if(this.isLeading&&this.digitType==1){t=1/36000;r=u.hourH}}}}}}var k=(1-this.afont.beginAniTime);var g=(1-this.afont.endAniTime);this.beginAniTime=1-k*r*t;this.endAniTime=1-g*t}this.beginAniTimeOriginal=this.beginAniTime;this.endAniTimeOriginal=this.endAniTime;this.baseLineWidth=h.baseLineWidth;this.partLineWidth=h.partLineWidth;if(e==3&&h.secondsScale!=undefined){var y=0.75;this.baseLineWidth=Math.round(h.baseLineWidth*(1*y+(1-y)*h.secondsScale.val));this.partLineWidth=Math.round(h.partLineWidth*(1*y+(1-y)*h.secondsScale.val))}this.basedigits=animaclock_basedigits();this.transition=animaclock_transitions();var o=this.width/10;var l=this.height/20;var b=this.afont.lineGap;this.pt=[[[this.left+o*(1+b),this.top+l],[this.left+this.width-o*(1+b),this.top+l]],[[this.left+o,this.top+l*(1+b)],[this.left+o,this.top+this.height/2-l/2*(1+b)]],[[this.left+this.width-o,this.top+l*(1+b)],[this.left+this.width-o,this.top+this.height/2-l/2*(1+b)]],[[this.left+o*(1+b),this.top+this.height/2],[this.left+this.width-o*(1+b),this.top+this.height/2]],[[this.left+o,this.top+this.height/2+l/2*(1+b)],[this.left+o,this.top+this.height-l*(1+b)]],[[this.left+this.width-o,this.top+this.height/2+l/2*(1+b)],[this.left+this.width-o,this.top+this.height-l*(1+b)]],[[this.left+o*(1+b),this.top+this.height-l],[this.left+this.width-o*(1+b),this.top+this.height-l]]];this.currentNum=[];this.currentNumRound=[];this.currentNumOver=[];this.ptMeta=new Array();for(var w=0;w<this.pt.length;w++){this.ptMeta[w]=animaclock_getPtInfo(this.pt[w])}if(!this.afont.sevenSegment){this.strokeMeta=new Array();for(var w=0;w<this.strokes.length;w++){this.strokeMeta[w]=new Array();for(var v=0;v<this.strokes[w].length;v++){this.strokeMeta[w][v]=animaclock_getStrokeInfo(this.strokes[w][v])}}}}function animaclock_getStrokeInfo(g){var a=animaclock_averagePoint(g);var b=[];var c=[];var e=[];var f=[];for(var d=0;d<4;d++){b[d]=g[d][1]-a[1];c[d]=g[d][0]-a[0];e[d]=Math.atan2(b[d],c[d]);f[d]=Math.sqrt(b[d]*b[d]+c[d]*c[d])}return{m:a,theta:e,r:f}}function animaclock_getPtInfo(f){var a=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2];var b=f[0][1]-a[1];var c=f[0][0]-a[0];var d=Math.atan2(b,c);var e=Math.sqrt(b*b+c*c);return{m:a,theta:d,r:e}}function animaclock_drawDigit(a){var c=Math.floor(a);this.currentNum=a;this.currentNumRound=c;this.currentNumOver=a-c;var b=(this.currentNumOver-this.beginAniTime)/(this.endAniTime-this.beginAniTime);b=(b<0)?0:((b>1)?1:b);if(this.afont.baseInFront){this.drawPartDigit(c,b);this.drawBaseDigit(c)}else{this.drawBaseDigit(c);this.drawPartDigit(c,b)}}function animaclock_drawBaseDigitPrepare(a){if((a==0)&&(this.digitType==1)&&this.isLeading){return false}if(this.baseLineWidth<1){return false}if(this.afont.pulsate!=false){this.context.lineWidth=animaclock_pulsate(this.baseLineWidth,this.currentNumOver)}else{this.context.lineWidth=this.baseLineWidth}this.context.strokeStyle=animaclock_col2str(this.baseColor);return true}function animaclock_drawBaseDigit(b){if(!this.drawBaseDigitPrepare(b)){return}var a=this.basedigits[b];for(i=0;i<a.length;i++){this.drawBaseDigitEdge(a[i])}}function animaclock_drawBaseDigitEdge(c){if(!this.digitPanel.aniclock.alarmOn){animaclock_drawline(this.context,this.pt[c][0][0],this.pt[c][0][1],this.pt[c][1][0],this.pt[c][1][1])}else{var d=this.digitPanel.aniclock.alarm;if(d.animation!=undefined){var b=this.getGlobalAnimation_pos(this.pt[c][0][0],this.pt[c][0][1],this.digitPanel.aniclock.alarmLoopT,d.animation);var a=this.getGlobalAnimation_pos(this.pt[c][1][0],this.pt[c][1][1],this.digitPanel.aniclock.alarmLoopT,d.animation);animaclock_drawline(this.context,b[0],b[1],a[0],a[1])}}}function animaclock_drawPartDigitPrepare(e,c){var b;if(!this.afont.pulsate){b=this.partLineWidth}else{b=animaclock_pulsate(this.partLineWidth,this.currentNumOver)}if(b<1){return false}this.context.lineWidth=b;var a;if(this.digitPanel.aniclock.timerOn&&this.digitPanel.aniclock.timerCountsDown){if(e>0){a=e-1}else{if(this.isLeading){a=50}else{a=9}}}else{a=e;if(this.digitType==1){if(e==0&&this.isLeading){a=11}else{if(!this.digitPanel.aniclock.is24hour){if(e==1&&this.isLeading){a=10}else{if(e==2&&(this.digitPanel.hourTime>10)&&!this.isLeading){a=21}}}else{if(e==2&&this.isLeading){a=20}else{if(e==3&&(this.digitPanel.hourTime>20)&&!this.isLeading){a=30}}}}}else{if(e==5&&this.isLeading==1){a=50}}}var d=this.afont.t[a];return{map:d,mapVal:a,targetWidth:b}}function animaclock_drawPartDigit(C,q){var A=this.drawPartDigitPrepare(C,q);if(A==false){return}var D=A.map;var d=A.targetWidth;for(var s=0;s<D.length;s++){var u=D[s];var e=u.src;var p=[[this.pt[e][0][0],this.pt[e][0][1]],[this.pt[e][1][0],this.pt[e][1][1]]];var o=q;if(u.t!=undefined){var B=(q-u.t[0])/(u.t[1]-u.t[0]);B=(B<0)?0:B;B=(B>1)?1:B;o=B}if(u.pre!=undefined&&u.pre=="off"&&o<=0){continue}if(u.post!=undefined&&u.post=="off"&&o>=1){continue}if(u.via!=undefined){if(u.via=="osc"){o=animaclock_oscillate(o)}else{if(u.via=="acc"){o=o*o}}}if(u.col==undefined){this.context.strokeStyle=animaclock_colorOfTime(this.afont.partColor,o)}else{this.context.strokeStyle=animaclock_colorOfTime(u.col,o)}var b=0;var r=d;switch(u.type){case"shrink":p=getAniPos_shrink(p,u.mov,o);b=1;break;case"grow":p=getAniPos_grow(p,u.mov,o);b=1;break;case"shift":var n=[[this.pt[u.to][0][0],this.pt[u.to][0][1]],[this.pt[u.to][1][0],this.pt[u.to][1][1]]];p=getAniPos_shift(p,n,o);b=1;break;case"flip":var n=[[this.pt[u.to][1][0],this.pt[u.to][1][1]],[this.pt[u.to][0][0],this.pt[u.to][0][1]]];p=getAniPos_shift(p,n,o);b=1;break;case"loop":nTurns=u.turns==undefined?1:u.turns;p=getAniPos_loop(this.ptMeta[e],this.ptMeta[u.to],o,nTurns);b=1;break;case"inflate":if(o>0){var r=Math.round(o*d);if(r>0){b=1}}break;case"deflate":if(o<1){r=Math.round((1-o)*d);if(r>0){b=1}}break;default:break}if(b){this.context.lineWidth=r;if(!this.digitPanel.aniclock.alarmOn){animaclock_drawline(this.context,p[0][0],p[0][1],p[1][0],p[1][1]);if(this.digitPanel.aniclock.labelStroke){var j=(p[0][0]+p[1][0])/2;var g=(p[0][1]+p[1][1])/2;var k=u.src;if(u.src!=u.to&&u.to!=undefined){k=u.src+"->"+u.to}var c=animaclock_col2str(animaclock_invertColor(this.digitPanel.currentBGColor()));var f=this.context.strokeStyle;this.context.strokeStyle=c;var z=this.context.fillStyle;this.context.fillStyle=c;this.context.font="18px Arial";this.context.fillText(k+"",j,g);this.context.fillStyle=z;this.context.strokeStyle=f}}else{var a=this.digitPanel.aniclock.alarm;var l=this.getGlobalAnimation_pos(p[0][0],p[0][1],this.digitPanel.aniclock.alarmLoopT,a.animation);var h=this.getGlobalAnimation_pos(p[1][0],p[1][1],this.digitPanel.aniclock.alarmLoopT,a.animation);animaclock_drawline(this.context,l[0],l[1],h[0],h[1])}this.context.lineWidth=d}}}function getAniPos_loop(g,f,d,c){var b=[g.m[0]*(1-d)+f.m[0]*d,g.m[1]*(1-d)+f.m[1]*d];var e=g.theta*(1-d)+(2*Math.PI*c+f.theta)*d;var a=g.r*(1-d)+f.r*d;var h=a*Math.sin(e);var j=a*Math.cos(e);return[[b[0]+j,b[1]+h],[b[0]-j,b[1]-h]]}function getAniPos_shift(e,f,c){var a=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]];for(var d=0;d<2;d++){for(var b=0;b<2;b++){a[d][b]=f[d][b]*c+e[d][b]*(1-c)}}return a}function getAniPos_shrink(e,a,d){var b=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]];var f=a==0?1:0;for(var c=0;c<2;c++){b[a][c]=e[f][c]*d+e[a][c]*(1-d)}return b}function getAniPos_grow(c,a,b){return getAniPos_shrink(c,a,1-b)};
function animaclock_digitPanel(s,l,d,j,a,g,c,h,k){var i=d;this.canvas=c;this.context=this.canvas.getContext("2d");this.afont=h;this.aniclock=k;this.hour=new Array();var b=this.afont.hoursScale.val;var r=Math.round(a*b);var m=Math.round(g*b);var f=Math.round(s*b);var n=j;if(this.afont.hoursScale.pos=="bottom"){n=j+g-m}else{if(this.afont.hoursScale.pos=="middle"){n=j+g/2-m/2}}var p=this.afont.hoursScale.offset[0]*a;var o=this.afont.hoursScale.offset[1]*g;this.hour[0]=new animaclock_digit(i+p,n+o,r,m,true,1,h.baseColor,this.canvas,this.context,h,this);i+=r+f;this.hour[1]=new animaclock_digit(i+p,n+o,r,m,false,1,h.baseColor,this.canvas,this.context,h,this);i+=r+f/2;i+=l/2;this.colonLeftX=i+p;this.colonLeftYTop=n+o+0.34*m;this.colonLeftYBottom=n+o+0.66*m;i+=l/2;i+=s/2;this.minute=new Array();var q=this.afont.minutesScale.val;var r=Math.round(a*q);var m=Math.round(g*q);var f=Math.round(s*q);var n=j;if(this.afont.minutesScale.pos=="bottom"){n=j+g-m}else{if(this.afont.minutesScale.pos=="middle"){n=j+g/2-m/2}}var p=this.afont.minutesScale.offset[0]*a;var o=this.afont.minutesScale.offset[1]*g;this.minute[0]=new animaclock_digit(i+p,n+o,r,m,true,2,h.baseColor,this.canvas,this.context,h,this);i+=r+f;this.minute[1]=new animaclock_digit(i+p,n+o,r,m,false,2,h.baseColor,this.canvas,this.context,h,this);i+=r+f/2;i+=l/2;this.colonRightX=i+p;this.colonRightYTop=n+o+0.34*m;this.colonRightYBottom=n+o+0.66*m;i+=l/2;i+=s/2;this.second=new Array();var e=this.afont.secondsScale.val;var r=Math.round(a*e);var m=Math.round(g*e);var f=Math.round(s*e);var n=j;if(this.afont.secondsScale.pos=="bottom"){n=j+g-m}else{if(this.afont.secondsScale.pos=="middle"){n=j+g/2-m/2}}var p=this.afont.secondsScale.offset[0]*a;var o=this.afont.secondsScale.offset[1]*g;this.second[0]=new animaclock_digit(i+p,n+o,r,m,true,3,h.secondColor,this.canvas,this.context,h,this);i+=r+f;this.second[1]=new animaclock_digit(i+p,n+o,r,m,false,3,h.secondColor,this.canvas,this.context,h,this);i+=r+f;if(!this.aniclock.is24hour){this.ampmX=0;this.ampmY=0;switch(h.ampm.pos){case"bottomRight":this.ampmX=i+f;this.ampmY=n+m;this.context.textBaseline="bottom";break;case"middleRight":this.ampmX=i+f;this.ampmY=n+m/2;this.context.textBaseline="middle";break;case"topRight":this.ampmX=i+f;this.ampmY=n;this.context.textBaseline="top";break;case"bottomLeft":this.ampmX=d-s;this.ampmY=j+g;this.context.textBaseline="bottom";break;case"middleLeft":this.ampmX=d-s;this.ampmY=j+g/2;this.context.textBaseline="middle";break;case"topLeft":this.ampmX=d-s;this.ampmY=j;this.context.textBaseline="top";break;default:break}this.context.font=h.ampm.font}this.render=animaclock_renderPanel;this.renderColons=animaclock_renderPanelColons;this.renderAMPM=animaclock_renderAMPM;this.renderSettingAlarmMessage=animaclock_renderSettingAlarmMessage;this.renderBackground=animaclock_renderBackground;this.currentBGColor=animaclock_currentBGColor;this.adjustAniTimesBackwards=animaclock_adjustAniTimesBackwards;this.adjustAniTimesForwards=animaclock_adjustAniTimesForwards;this.colonRadius=h.colonRadius;this.colonLeftTop=this.colonLeftYTop;this.colonLeftBot=this.colonLeftYBottom;this.colonRightTop=this.colonRightYTop;this.colonRightBot=this.colonRightYBottom;this.currentTime=[];this.secondsOver=[];this.hourTime=[]}function animaclock_adjustAniTimesBackwards(){for(var a=0;a<2;a++){this.hour[a].beginAniTime=1-this.hour[a].endAniTimeOriginal;this.hour[a].endAniTime=1-this.hour[a].beginAniTimeOriginal;this.minute[a].beginAniTime=1-this.minute[a].endAniTimeOriginal;this.minute[a].endAniTime=1-this.minute[a].beginAniTimeOriginal;this.second[a].beginAniTime=1-this.second[a].endAniTimeOriginal;this.second[a].endAniTime=1-this.second[a].beginAniTimeOriginal}}function animaclock_adjustAniTimesForwards(){for(var a=0;a<2;a++){this.hour[a].beginAniTime=this.hour[a].beginAniTimeOriginal;this.hour[a].endAniTime=this.hour[a].endAniTimeOriginal;this.minute[a].beginAniTime=this.minute[a].beginAniTimeOriginal;this.minute[a].endAniTime=this.minute[a].endAniTimeOriginal;this.second[a].beginAniTime=this.second[a].beginAniTimeOriginal;this.second[a].endAniTime=this.second[a].endAniTimeOriginal}}function animaclock_renderPanel(a,e,c){this.secondsOver=this.currentTime.getMilliseconds()/1000;var k=animaclock_fracDecimate(a);var j=animaclock_fracDecimate(e);var i=animaclock_fracDecimate(c);this.hourTime=a;if((Math.floor(a)>=10)&&!this.aniclock.is24hour){k[0]=1+(a-10)/3}else{if((Math.floor(a)>=20)&&this.aniclock.is24hour){k[0]=2+(a-20)/4}}var b=this.aniclock.alarm;if(this.aniclock.alarmOn){var f=1000*this.currentTime.getSeconds()+this.currentTime.getMilliseconds();var d=f%(Math.round(1000*b.loopLength));d/=(b.loopLength*1000);this.aniclock.alarmLoopT=d}this.context.save();this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var g=true;if(this.aniclock.alarmOn){var h=animaclock_colorOfTime(b.bgColor,this.aniclock.alarmLoopT);this.context.fillStyle=h;this.context.fillRect(0,0,this.canvas.width,this.canvas.height);g=false}if(g){this.renderBackground()}if(!this.aniclock.is24hour){this.renderAMPM()}this.renderColons(Math.floor(parseFloat(c)));this.hour[0].drawDigit(k[0]);this.hour[1].drawDigit(k[1]);this.minute[0].drawDigit(j[0]);this.minute[1].drawDigit(j[1]);this.second[0].drawDigit(i[0]);this.second[1].drawDigit(i[1]);if(this.aniclock.settingAlarm){this.renderSettingAlarmMessage()}this.context.restore()}function animaclock_renderSettingAlarmMessage(){this.context.textBaseline="top";this.context.textAlign="left";var a=animaclock_col2str(animaclock_invertColor(this.currentBGColor()));this.context.fillStyle=a;animaclock_drawText(this.context,"SETTING ALARM",10,10)}function animaclock_renderAMPM(){var b=this.aniclock.meridiem;if(this.afont.ampm.capital){b=b.toUpperCase()}this.context.fillStyle=animaclock_col2str(this.afont.ampm.color);var a=this.ampmX;var d=this.ampmY;if(this.aniclock.alarmOn){var c=this.hour[0].getGlobalAnimation_pos(a,d,this.aniclock.alarmLoopT,this.afont.alarm.animation);a=c[0];d=c[1]}if(this.afont.ampmShow){animaclock_drawText(this.context,b,a,d)}}function animaclock_currentBGColor(){if(this.afont.bgColor!=undefined){if(this.afont.bgColor.am==undefined){return this.afont.bgColor}else{var a=this.aniclock.meridiem=="am";if(a){return this.afont.bgColor.am}else{return this.afont.bgColor.pm}}}return null}function animaclock_renderBackground(){var a=this.currentBGColor();if(a!=null){this.context.fillStyle=animaclock_col2str(a);this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}}function animaclock_renderPanelColons(e){var c=0.5*((this.currentTime.getSeconds()%2)+this.currentTime.getMilliseconds()/1000);this.context.fillStyle=animaclock_colorOfTime(this.afont.colonColors,c);var g=this.colonRadius;if(this.colonRadius.length==2){var a=0.5+0.5*Math.sin(2*Math.PI*c);g=this.colonRadius[0]*a+this.colonRadius[1]*(1-a)}if(!this.aniclock.alarmOn){animaclock_fillcircle(this.context,this.colonLeftX,this.colonLeftTop,g);animaclock_fillcircle(this.context,this.colonLeftX,this.colonLeftBot,g);if(this.afont.showRightColons){animaclock_fillcircle(this.context,this.colonRightX,this.colonRightTop,g);animaclock_fillcircle(this.context,this.colonRightX,this.colonRightBot,g)}}else{var f=this.aniclock.alarm;var d=this.hour[0].getGlobalAnimation_pos(this.colonLeftX,this.colonLeftTop,this.aniclock.alarmLoopT,f.animation);var b=this.hour[0].getGlobalAnimation_pos(this.colonRightX,this.colonRightBot,this.aniclock.alarmLoopT,f.animation);animaclock_fillcircle(this.context,d[0],d[1],g);animaclock_fillcircle(this.context,d[0],b[1],g);animaclock_fillcircle(this.context,b[0],d[1],g);animaclock_fillcircle(this.context,b[0],b[1],g)}};
function embedAnimaClock(g,b,h,e,f,c,d,i,a){this.canvasId="canvas"+g;var j="<a href='http://animaclock.com'>";j+="<canvas id='"+this.canvasId+"' width="+b+" height="+h+"></canvas>";j+="</a>";document.getElementById(g).innerHTML=j;this.waitForCanvas=function(){var l=document.getElementById(this.canvasId);if(l==undefined||l==null){setTimeout(this.waitForCanvas.bind(this),25)}else{var k=new animaClock(this.canvasId,e,f,c,d,i,a)}};this.waitForCanvas()};
function animaclock_cloneFontSetDefaults(b){var e=new Array();for(var g in b){e[g]=b[g]}if(e.strokes!=undefined){e.sevenSegment=false}e.scaledDurations=(e.disableSlowest==undefined)?false:(!e.disableSlowest);var f={lineGap:0,digitPad:4,groupPad:15,heightFrac:0.9,widthFrac:0.9,baseColor:[100,100,100],partColor:[150,150,150],secondColor:[150,150,150],baseLineWidth:9,partLineWidth:6,colonRadius:5,beginAniTime:0,endAniTime:1,baseInFront:true,pulsate:false,scaledDurations:false,transitionDurations:{secL:1,secH:3,minL:9,minH:12,hourL:12,hourH:12},colonColors:{a:[100,100,100],b:[150,150,150],t:0.5},lineCap:"butt",alarm:{loopLength:1,bgColor:{a:[200,200,200],b:[100,100,100],t:0.5},animation:{type:"expand",min:0.35,max:1.25}},ampmShow:true,ampm:{font:"11px 'Helvetica Neue',Helvetica,Arial,sans-serif;",pos:"bottomRight",capital:false,color:e.baseColor!=undefined?e.baseColor:[0,0,0]},showRightColons:true,hoursScale:{val:1,pos:"top",offset:[0,0]},minutesScale:{val:1,pos:"top",offset:[0,0]},secondsScale:{val:0.6,pos:"top",offset:[0,0]},sevenSegment:true,connected:false,strokes:[[[[125,63],[60,63],[60,187],[125,187]],[[125,187],[190,187],[190,63],[125,63]]],[[[125,63],[125,104.33333333333333],[125,145.66666666666666],[125,187]]],[[[92,67],[224,49],[125,145.66666666666666],[88,187]],[[88,187],[100,187],[113,187],[165,187]]],[[[96,66],[160,59],[192,92],[96,118]],[[96,118],[177,112],[173,200],[96,187]]],[[[95,67],[73,139],[127,128],[157,126]],[[156,63],[156,104.33333333333333],[156,145.66666666666666],[156,187]]],[[[158,63],[125,63],[125,63],[97,63]],[[98,64],[69,172],[159,76],[159,159]],[[159,159],[162,199],[93,196],[91,163]]],[[[129,65],[79,55],[46,177],[125,187]],[[125,187],[172,187],[173,121],[125,125]],[[125,125],[104,128],[90,138],[85,160]]],[[[87,63],[125,63],[125,63],[158,63]],[[158,63],[147,84],[136,104],[87,187]]],[[[135,128],[118,119],[67,68],[126,65]],[[126,65],[191,68],[113,113],[104,131]],[[104.75,130],[69.75,161],[112,201],[136,183]],[[136,183],[156,171],[161,147],[135,128]]],[[[100,173],[174,234],[192,77],[145,65]],[[145,65],[84,58],[76,134],[130,131]],[[129,131],[153,131],[173,112],[169,100]]]],defaultTrans:"shrinkgrow",t:[]};var a=function(i,k){if(i==undefined){return k}if(animaclock_isNumberOrString(i)){return i}for(var j in k){if(i[j]==undefined){i[j]=k[j]}else{if(j=="strokes"){continue}if(!animaclock_isNumberOrString(k[j])){for(var h in k[j]){if(i[j][h]==undefined){i[j][h]=k[j][h]}}}}}return i};e=a(e,f);e.colonColors=animaclock_colorArrayToSpec(e.colonColors);var c=function(h){var i={t:[0,1],col:e.partColor,via:"acc",pre:"on",post:"on"};h=a(h,e.defaultTrans);h=a(h,i);return h};var d=function(I){var h=[];if(I.sevenSegment){for(var E=0;E<10;E++){h[E]=7}}else{for(var E=0;E<10;E++){h[E]=I.strokes[E].length}}var l=animaclock_transitions();var w=animaclock_isNumberOrString(I.defaultTrans)?I.defaultTrans:I.defaultTrans.type;var A=(w=="deflateinflate")?"inflate":"grow";var j=(w=="deflateinflate")?"deflate":"shrink";for(var s in I.t){if(l[s]==undefined){continue}var t=(l[s][0]!=null)?h[l[s][0]]:0;var v=(l[s][1]!=null)?h[l[s][1]]:0;var r=[];for(var q in I.t[s]){var H=true;var L=I.t[s][q];if(L.src==undefined||L.type==undefined){H=false}else{if((L.type=="grow"||L.type=="inflate")&&L.src>=v){H=false}else{if(L.src!=undefined&&L.src>=t&&L.type!="grow"&&L.type!="inflate"){H=false}else{if(L.to!=undefined&&L.to>=v){H=false}}}}if(H){r.push(L)}}I.t[s]=r}var z=function(N){if(N==undefined){return true}if(N.length==0){return true}for(var M in N){if(N[M].src!=undefined){return false}}return true};var m=animaclock_basedigits();for(var G in l){if(!z(I.t[G])){continue}var K=[];var u=l[G][0];var p=l[G][1];var t=(u!=null)?h[u]:0;var v=(p!=null)?h[p]:0;if(I.sevenSegment){if(w=="shrinkgrow"||w=="deflateinflate"||v==0||t==0){for(var F=0;F<7;F++){var C=animaclock_isMember(m[u],F);var D=animaclock_isMember(m[p],F);if(C&&D){K.push(c({src:F,type:"shift",to:F}))}else{if(C&&!D){K.push(c({src:F,type:j,mov:0}))}else{if(!C&&D){K.push(c({src:F,type:A,mov:0}))}}}}}else{var B=[];for(var y in m[u]){var o=m[u][y];var k=animaclock_nearestMember(m[p],o);B[o+"|"+k]=1;K.push(c({src:o,to:k,type:w}))}for(var n in m[p]){var k=m[p][n];var o=animaclock_nearestMember(m[u],k);if(!B[o+"|"+k]){K.push(c({src:o,to:k,type:w}))}}}}else{if(w=="shrinkgrow"||w=="deflateinflate"||v==0||t==0){for(var E=0;E<t;E++){K.push(c({src:E,type:j,mov:0}))}for(var E=0;E<v;E++){K.push(c({src:E,type:A,mov:0}))}}else{var x=animaclock_range(0,t-1);var J=animaclock_range(0,v-1);var B=[];for(var y in x){var o=x[y];var k=animaclock_nearestMember(J,o);B[o+"|"+k]=1;K.push(c({src:o,to:k,type:w}))}for(var n in J){var k=J[n];var o=animaclock_nearestMember(x,k);if(!B[o+"|"+k]){K.push(c({src:o,to:k,type:w}))}}}}I.t[G]=K}return I};e=d(e);return e};
function previewAnimaClock(c,a,b){this.clockType="preview";this.canvas=document.getElementById(c);this.context=this.canvas.getContext("2d");this.updateInterval=(b!=undefined)?b:25;this.updateIntervalOriginal=this.updateInterval;this.animationLength=3;this.anifont=animaclock_cloneFontSetDefaults(a);this.context.lineCap=this.anifont.lineCap;this.labelStroke=true;this.is24hour=0;this.isKilled=false;this.safeKill=function(){for(var d in this){this[d]=null}};this.animateClock=function(){if(this.isKilled){this.safeKill();return}var d=new Date();var e=d.getSeconds()+d.getMilliseconds()/1000;this.digitPanel.currentTime=d;this.digitPanel.render(e);setTimeout(this.animateClock.bind(this),this.updateInterval)};this.startDigitPanel=function(){var f=this.canvas;afont=this.anifont;var k=f.width*afont.widthFrac;var d=Math.round((k-4*afont.groupPad-10*afont.digitPad)/11);var j=Math.round((f.height*afont.heightFrac-2*afont.digitPad)/2);var e=Math.round(f.height*(1-afont.heightFrac)/2);var h=Math.round(f.width*(1-afont.widthFrac)/2);this.anifont.baseLineWidth=Math.ceil(f.width/600*afont.baseLineWidth*6/11);this.anifont.partLineWidth=Math.ceil(f.width/600*afont.partLineWidth*6/11);if(this.anifont.colonRadius.length==2){for(var g=0;g<2;g++){this.anifont.colonRadius[g]=Math.ceil(f.width/600*afont.colonRadius[g]*6/11)}}else{this.anifont.colonRadius=Math.ceil(f.width/600*afont.colonRadius*6/11)}return new animaclock_previewDigitPanel(this.anifont.digitPad,this.anifont.groupPad,h,e,d,j,this.canvas,this.anifont,this)};this.kill=function(){this.isKilled=true};this.digitPanel=this.startDigitPanel();setTimeout(this.animateClock.bind(this),this.updateInterval)};
function animaclock_previewDigitPanel(e,d,c,h,f,a,b,k,g){var j=c;this.canvas=b;this.context=this.canvas.getContext("2d");this.afont=k;this.aniclock=g;this.second=new Array();this.second[0]=new animaclock_digit(j,h,f,a,1,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.second[1]=new animaclock_digit(j,h,f,a,0,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;j+=d/2;this.colonLeftX=j;j+=d/2;this.second[2]=new animaclock_digit(j,h,f,a,1,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.second[3]=new animaclock_digit(j,h,f,a,0,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;j+=d/2;j+=d/2;this.second[4]=new animaclock_digit(j,h,f,a,1,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.second[5]=new animaclock_digit(j,h,f,a,0,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;j+=d/2;j+=d/2;this.second[6]=new animaclock_digit(j,h,f,a,1,3,k.secondColor,this.canvas,this.context,k,this);j+=f+e;this.second[7]=new animaclock_digit(j,h,f,a,0,3,k.secondColor,this.canvas,this.context,k,this);j+=f+e;j+=d/2;this.colonRightX=j;j+=d/2;this.second[8]=new animaclock_digit(j,h,f,a,1,3,k.secondColor,this.canvas,this.context,k,this);j+=f+e;this.second[9]=new animaclock_digit(j,h,f,a,0,3,k.secondColor,this.canvas,this.context,k,this);j=c;var i=h;h=h+a+2*e;this.second[50]=new animaclock_digit(j,h,f,a,1,2,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.second[10]=new animaclock_digit(j,h,f,a,1,1,k.baseColor,this.canvas,this.context,k,this);j+=f+e;j+=d/2;j+=d/2;this.second[21]=new animaclock_digit(j,h,f,a,0,1,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.second[20]=new animaclock_digit(j,h,f,a,1,1,k.baseColor,this.canvas,this.context,k,this);j+=f+e;j+=d/2;j+=d/2;this.second[30]=new animaclock_digit(j,h,f,a,0,1,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.second[11]=new animaclock_digit(j,h,f,a,1,1,k.baseColor,this.canvas,this.context,k,this);j+=f+e;this.render=animaclock_previewRenderPanel;this.renderColons=animaclock_renderPanelColons;this.renderBackground=animaclock_renderBackground;this.currentBGColor=animaclock_currentBGColor;this.colonRadius=k.colonRadius;this.colonTop=i+Math.round(a*0.34);this.colonBot=i+Math.round(a*0.66);this.currentTime=[];this.secondsOver=[];this.hourTime=0}function animaclock_previewRenderPanel(b){this.secondsOver=(this.currentTime.getSeconds()%this.aniclock.animationLength)+this.currentTime.getMilliseconds()/1000;this.secondsOver/=this.aniclock.animationLength;this.context.save();this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.renderBackground();this.renderColons(Math.floor(parseFloat(b)));for(var a=0;a<10;a++){this.second[a].drawDigit(a+this.secondsOver)}this.hourTime=0;this.aniclock.is24hour=0;this.second[50].drawDigit(5+this.secondsOver);this.hourTime=11;this.aniclock.is24hour=0;this.second[10].drawDigit(1+this.secondsOver);this.hourTime=12;this.aniclock.is24hour=0;this.second[21].drawDigit(2+this.secondsOver);this.hourTime=21;this.aniclock.is24hour=1;this.second[20].drawDigit(2+this.secondsOver);this.hourTime=23;this.aniclock.is24hour=1;this.second[30].drawDigit(3+this.secondsOver);this.hourTime=0;this.aniclock.is24hour=0;this.second[11].drawDigit(0+this.secondsOver);this.context.restore()};
function animaclock_drawBaseSmoothDigit(f){if(!this.drawBaseDigitPrepare(f)){return}var c=this.strokes[f];if(!this.digitPanel.aniclock.alarmOn){for(var d=0;d<c.length;d++){animaclock_drawcurve(this.context,c[d])}}else{var e=this.digitPanel.aniclock.alarm;for(var b=0;b<c.length;b++){var a=animaclock_clone(c[b]);for(var d=0;d<4;d++){a[d]=this.getGlobalAnimation_pos(a[d][0],a[d][1],this.digitPanel.aniclock.alarmLoopT,e.animation)}animaclock_drawcurve(this.context,a)}}}function animaclock_drawPartSmoothDigit(E,q){var C=this.drawPartDigitPrepare(E,q);if(C==false){return}var F=C.map;var e=C.targetWidth;var B=this.transition[C.mapVal][0];var g=this.transition[C.mapVal][1];if(this.afont.connected){animaclock_startcurve(this.context)}for(var s=0;s<F.length;s++){var u=F[s];var f=u.src;var o=q;if(u.t!=undefined){var D=(q-u.t[0])/(u.t[1]-u.t[0]);D=(D<0)?0:D;D=(D>1)?1:D;o=D}if(u.pre!=undefined&&u.pre=="off"&&o<=0){continue}if(u.post!=undefined&&u.post=="off"&&o>=1){continue}if(u.via!=undefined){if(u.via=="osc"){o=animaclock_oscillate(o)}else{if(u.via=="acc"){o=o*o}}}if(u.col==undefined){this.context.strokeStyle=animaclock_colorOfTime(this.afont.partColor,o)}else{this.context.strokeStyle=animaclock_colorOfTime(u.col,o)}var b=0;var r=e;var p=null;if((B!=null)&&(u.src<this.strokes[B].length)){p=animaclock_clone(this.strokes[B][u.src])}else{if((B!=null)&&(u.type=="grow"||u.type=="inflate")&&(u.src<this.strokes[g].length)){p=animaclock_clone(this.strokes[g][u.src])}}switch(u.type){case"shift":var n=this.strokes[g][u.to];p=getAniPos2_shift(p,n,o);b=1;break;case"flip":var n=this.strokes[g][u.to];p=getAniPos2_flip(p,n,o);b=1;break;case"shrink":p=getAniPos2_shrink(p,u.mov,o);b=1;break;case"grow":p=this.strokes[g][u.src];p=getAniPos2_grow(p,u.mov,o);b=1;break;case"inflate":p=this.strokes[g][u.src];if(o>0){var r=Math.round(o*e);if(r>0){b=1}}break;case"deflate":if(o<1){r=Math.round((1-o)*e);if(r>0){b=1}}break;case"loop":nTurns=u.turns==undefined?1:u.turns;p=getAniPos2_loop(this.strokeMeta[B][u.src],this.strokeMeta[g][u.to],o,nTurns);b=1;break;default:break}if(b){this.context.lineWidth=r;if(!this.digitPanel.aniclock.alarmOn){if(this.digitPanel.aniclock.anifont.connected){animaclock_continuecurve(this.context,p)}else{animaclock_drawcurve(this.context,p)}if(this.digitPanel.aniclock.labelStroke){var l=(p[0][0]+p[3][0])/2;var j=(p[0][1]+p[3][1])/2;var k=u.src;if(u.src!=u.to&&u.to!=undefined){k=u.src+"->"+u.to}var d=animaclock_col2str(animaclock_invertColor(this.digitPanel.currentBGColor()));var h=this.context.strokeStyle;this.context.strokeStyle=d;var z=this.context.fillStyle;this.context.fillStyle=d;this.context.font="18px Arial";this.context.fillText(k+"",l,j);this.context.fillStyle=z;this.context.strokeStyle=h}}else{var a=this.digitPanel.aniclock.alarm;var c=animaclock_clone(p);for(var A=0;A<4;A++){c[A]=this.getGlobalAnimation_pos(p[A][0],p[A][1],this.digitPanel.aniclock.alarmLoopT,a.animation)}if(this.digitPanel.aniclock.anifont.connected){animaclock_continuecurve(this.context,p)}else{animaclock_drawcurve(this.context,p)}}this.context.lineWidth=e}}}function getAniPos2_loop(j,g,e,d){var b=[j.m[0]*(1-e)+g.m[0]*e,j.m[1]*(1-e)+g.m[1]*e];var h=[];for(var c=0;c<4;c++){var f=j.theta[c]*(1-e)+(2*Math.PI*d+g.theta[c])*e;var a=j.r[c]*(1-e)+g.r[c]*e;var k=a*Math.sin(f);var l=a*Math.cos(f);h[c]=[b[0]+l,b[1]+k]}return h}function getAniPos2_flip(d,e,b){v=animaclock_clone(d);for(var c=0;c<4;c++){for(var a=0;a<2;a++){v[c][a]=e[3-c][a]*b+d[c][a]*(1-b)}}return v}function getAniPos2_shift(d,e,b){v=animaclock_clone(d);for(var c=0;c<4;c++){for(var a=0;a<2;a++){v[c][a]=e[c][a]*b+d[c][a]*(1-b)}}return v}function getAniPos2_shrink(f,a,d){var b=animaclock_clone(f);var g=a==0?3:0;for(var e=0;e<4;e++){if(e==g){continue}for(var c=0;c<2;c++){b[e][c]=f[g][c]*d+f[e][c]*(1-d)}}return b}function getAniPos2_grow(c,a,b){return getAniPos2_shrink(c,a,1-b)};
if(!("bind" in Function.prototype)){Function.prototype.bind=function(a){var c=this;var b=Array.prototype.slice.call(arguments,1);return function(){return c.apply(a,b.length===0?arguments:arguments.length===0?b:b.concat(Array.prototype.slice.call(arguments,0)))}}}function animaclock_averagePoint(a){var d=0;var c=0;for(var b=0;b<a.length;b++){d+=a[b][0];c+=a[b][1]}return[d/a.length,c/a.length]}function animaclock_oscillate(a){var c=0.4;if(a<c){var b=a/c;return b*b}else{var b=(a-c)/(1-c);return 1+0.15*Math.sin(2*Math.PI*b)}}function animaclock_pulsate(c,e){var d=1.25;var b=0.75;var a=Math.round(c*(d-(d-b)*Math.sin(e*Math.PI)*Math.sin(e*Math.PI)));return a}function animaclock_fracDecimate(b){var c=b/10;var a=b-10*Math.floor(c);return[c,a]}function animaclock_normalizeStrokes(e,c,j,a,l,d){e=animaclock_clone(e);var h=animaclock_strokesBoundingBox(e);var k=(a-2*d)/h[2];var b=(l-2*d)/h[3];for(var i=0;i<e.length;i++){for(var f=0;f<e[i].length;f++){for(var g=0;g<e[i][f].length;g++){e[i][f][g][0]-=h[0];e[i][f][g][0]*=k;e[i][f][g][1]-=h[1];e[i][f][g][1]*=b;e[i][f][g][0]+=c+d;e[i][f][g][1]+=j+d}}}return e}function animaclock_strokesBoundingBox(a){var c=[];for(var d=0;d<a.length;d++){for(var b=0;b<a[d].length;b++){c.push(a[d][b])}}return animaclock_bezierBoundingBox(c)}function animaclock_bezierBoundingBox(s){var l=[[],[]];for(var u=0;u<s.length;u++){var F=s[u];var k=F[0];var j=F[1];var e=F[2];var d=F[3];l[0].push(k[0]);l[1].push(k[1]);l[0].push(d[0]);l[1].push(d[1]);for(var C=0;C<=1;C++){var E=function(a){return Math.pow(1-a,3)*k[C]+3*Math.pow(1-a,2)*a*j[C]+3*(1-a)*Math.pow(a,2)*e[C]+Math.pow(a,3)*d[C]};var G=6*k[C]-12*j[C]+6*e[C];var H=-3*k[C]+9*j[C]-9*e[C]+3*d[C];var F=3*j[C]-3*k[C];if(H==0){if(G==0){continue}var v=-F/G;if(0<v&&v<1){l[C].push(E(v))}continue}var g=G*G-4*F*H;if(g<0){continue}var p=(-G+Math.sqrt(g))/(2*H);if(0<p&&p<1){l[C].push(E(p))}var n=(-G-Math.sqrt(g))/(2*H);if(0<n&&n<1){l[C].push(E(n))}}}var A=function(c){var b=Infinity;for(var f in c){if(c[f]<b){b=c[f]}}return b};var B=function(c){var b=-Infinity;for(var f in c){if(c[f]>b){b=c[f]}}return b};var o=A(l[0]);var q=B(l[0])-o;var m=A(l[1]);var D=B(l[1])-m;var z=[o,m,q,D];return z}function animaclock_drawline(a,c,e,b,d){if(c==b&&e==d){return}a.beginPath();a.moveTo(c,e);a.lineTo(b,d);a.fill();a.stroke();a.closePath()}function animaclock_drawcurve(a,b){if(b[0][1]==b[3][1]&&b[0][0]==b[3][0]&&b[0][1]==b[1][1]&&b[0][0]==b[1][0]){return}a.beginPath();a.moveTo(b[0][0],b[0][1]);a.bezierCurveTo(b[1][0],b[1][1],b[2][0],b[2][1],b[3][0],b[3][1]);a.stroke();a.closePath()}var _animaclock_continuecurve_last=false;function animaclock_startcurve(a){_animaclock_continuecurve_last=false}function animaclock_continuecurve(a,b){if(b[0][1]==b[3][1]&&b[0][0]==b[3][0]&&b[0][1]==b[1][1]&&b[0][0]==b[1][0]){return}a.beginPath();if(_animaclock_continuecurve_last&&(_animaclock_continuecurve_last[3][1]!=b[0][1]||_animaclock_continuecurve_last[3][0]!=b[0][0])){a.moveTo(_animaclock_continuecurve_last[3][0],_animaclock_continuecurve_last[3][1]);a.lineTo(b[0][0],b[0][1])}a.moveTo(b[0][0],b[0][1]);a.bezierCurveTo(b[1][0],b[1][1],b[2][0],b[2][1],b[3][0],b[3][1]);_animaclock_continuecurve_last=b;a.stroke();a.closePath()}function animaclock_fillcircle(b,a,d,c){b.beginPath();b.arc(a,d,c,0,Math.PI*2,true);b.closePath();b.fill()}function animaclock_drawText(c,b,a,d){c.fillText(b,a,d)}function animaclock_col2str(a){if(a.length==3){return"rgb("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+")"}else{return"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]+")"}}function animaclock_col2hex(a){return"#"+animaclock_dec2hex(a[0],2)+animaclock_dec2hex(a[1],2)+animaclock_dec2hex(a[2],3)}function animaclock_dec2hex(c,b){var a=Number(c).toString(16);b=typeof(b)==="undefined"||b===null?b=2:b;while(a.length<b){a="0"+a}return a}function animaclock_colorOfTime(d,c){if(d.a==undefined){return animaclock_col2str(d)}else{var b=(d.t==undefined)?0.5:d.t;var a=(c<b)?(c/b):1-(c-b)/(1-b);if(d.a.length==3){return animaclock_col2str([d.a[0]*(1-a)+d.b[0]*a,d.a[1]*(1-a)+d.b[1]*a,d.a[2]*(1-a)+d.b[2]*a])}else{return animaclock_col2str([d.a[0]*(1-a)+d.b[0]*a,d.a[1]*(1-a)+d.b[1]*a,d.a[2]*(1-a)+d.b[2]*a,d.a[3]*(1-a)+d.b[3]*a])}}}function animaclock_isNumberOrString(b){var a=typeof b;return(a=="number")||(a=="string")}function animaclock_colorArrayToSpec(a){if(a.a==undefined){return{a:a[0],b:a[1],t:0.5}}return a}function animaclock_invertColor(a){if(a==undefined||a==null){return[0,0,0]}return[255-a[0],255-a[1],255-a[2]]}function animaclock_transitions(){var b=new Array();for(var a=0;a<10;a++){b[a]=[a,(a+1)%10]}b[50]=[5,0];b[10]=[1,null];b[21]=[2,1];b[20]=[2,null];b[30]=[3,0];b[11]=[null,1];return b}function animaclock_basedigits(){var a=[];a[0]=[0,1,2,4,5,6];a[1]=[2,5];a[2]=[0,2,3,4,6];a[3]=[0,2,3,5,6];a[4]=[1,2,3,5];a[5]=[0,1,3,5,6];a[6]=[0,1,3,4,5,6];a[7]=[0,2,5];a[8]=[0,1,2,3,4,5,6];a[9]=[0,1,2,3,5,6];return a}function animaclock_isNumeric(a){return(a-0)==a&&a.length>0}function animaclock_isMember(b,c){for(var d in b){if(b[d]==c){return true}}return false}function animaclock_nearestMember(c,d){var b=Infinity;var g=null;for(var e in c){var f=Math.abs(c[e]-d);if(f<b){b=f;g=c[e]}}return g}function animaclock_clone(a){var b=[];for(var c=0;c<a.length;c++){if(animaclock_isNumberOrString(a[c])){b[c]=a[c]}else{b[c]=animaclock_clone(a[c])}}return b}function animaclock_range(e,d){var c=[];for(var f=e;f<=d;f++){c.push(f)}return c}function animaclock_getCursorPosition(c,b){var a;var d;if(c.targetTouches!=undefined){a=c.targetTouches[0].pageX;d=c.targetTouches[0].pageY}else{if(c.pageX!=undefined&&c.pageY!=undefined){a=c.pageX;d=c.pageY}else{a=c.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;d=c.clientY+document.body.scrollTop+document.documentElement.scrollTop}}a-=$("#"+b).offset().left;d-=$("#"+b).offset().top;return[a,d]};
